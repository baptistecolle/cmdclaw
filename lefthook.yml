pre-commit:
  commands:
    secrets:
      run: gitleaks protect --staged --config .gitleaks.toml --redact
    lint:
      root: app
      run: bun run lint
    format:
      root: app
      run: bun run format:write
      stage_fixed: true
    typecheck:
      root: app
      run: bun run typecheck

pre-push:
  parallel: false
  commands:
    clean-tree:
      run: |
        if [ -n "$(git status --porcelain)" ]; then
          echo "pre-push blocked: working tree is not clean."
          echo "Commit or stash changes before pushing so checks run on the exact pushed code."
          git status --short
          exit 1
        fi
    check:
      root: app
      run: bun run check
    test:
      root: app
      run: bun run test
    build:
      root: app
      run: bun run build
      
